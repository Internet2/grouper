<html>
<head>
  <title>Grouper 0.5.5 Implementation Guide</title>
  <style>
<!--
#section { }
#subsection { }
#table {
  border: 1px solid black;
  border-collapse: collapse;
}
#td {
  padding: 3px;
}
#title {
  text-align: center;
}
-->
  </style>
</head>
<body>
<div id="summary">
grouper-0.5.5-impl-guide-01.html<br />
10 April 2005
</div>
<div id="title">
<h2>Grouper 0.5.5 Implementation Guide</h2>
</div>
<div id="body">
<p>
This guide will help you to build and operate Grouper 0.5.5. As this is
the initial release and there is as yet no previous experience with
Grouper implementation, even by its developers, the initial form of
this guide is far from a comprehensive treatment of the topic. Our
strategy is to bootstrap the documentation process by providing enough
information to enable early adopters to get going and subsequently
contribute to the enhancement of this document by their experiences.
</p>
<p>
Along with obtaining Grouper 0.5.5 (see the MACE-Dir-Groups website
<a href="http://middleware.internet2.edu/dir/groups">&lt;http://middleware.internet2.edu/dir/groups/&gt;</a>
for instructions), adopters should join the grouper-users at internet2
dot edu and possibly the grouper-dev at internet2 dot edu mailists
for collective self-help with implementation and to discuss ideas
for further development of Grouper.  Instructions for joining these
lists are also on the MACE-Dir-Groups website.
</p>
<div id="section">
<h3>1. Introduction To Grouper 0.5.5</h3>
</div>
<p>
Grouper 0.5.5 provides an API supporting basic groups management
capabilities - creation, update, and removal of groups from a Groups
Registry, subgroups, limited querying capabilities, and logging. It
also includes sample programs illustrating how to load data into and
extract data from the Groups Registry.
</p>
<p>
In <a href="http://middleware.internet2.edu/dir/groups/docs/draft-internet2-mace-dir-grouper-phase1-specs-04.html">Grouper Phase 1 Specifications</a>
the <a href="http://middleware.internet2.edu/dir/groups/docs/draft-internet2-mace-dir-grouper-phase1-specs-04.html#heading_2_Comp">components &amp; architecture section</a>
depicts the major components of Grouper and their relation to
elements of an implementation site's existing identity management
infrastructure. Those components are an API, a relational database
called the Groups Registry, a set of aging tasks, and one or more
user interfaces for managing groups. Grouper 0.5.5 is comprised of
an alpha release of the API and procedures to create the Groups
Registry within an HSQLDB database. The user interface, aging tasks,
and some substantial elements of API functionality are slated for
future release according to the following table.
</p>
<table id="table" align="center" border="1">
<th>Version</th>
<th>Description</th>
<tr>
  <td id="td">0.5</td>
  <td id="td">initial API release, Phase 1 specifications implemented (basic
    group management by automation processes)</td>
</tr>
<tr>
  <td id="td">0.6</td>
  <td id="td">initial UI release, supporting Phase 1 functionality</td>
</tr>
<tr>
  <td id="td">0.7</td>
  <td id="td">API meeting Phase 2 specs (group math &amp; signet
    integration)</td>
</tr>
<tr>
  <td id="td">0.8</td>
  <td id="td">UI supporting Phase 2 functionality</td>
</tr>
<tr>
  <td id="td">0.9</td>
  <td id="td">API meeting Phase 3 specs (aging of groups and of memberships)</td>
</tr>
<tr>
  <td id="td">1.0</td>
  <td id="td">UI supporting Phase 3 functionality</td>
</tr>
</table>
</div>
<p>
In section 2 of this document we'll start by describing how to
build, configure, and install the API and Groups Registry. We'll
lay out Grouper's information and privilege models in section 3 and
consider how they may integrate with existing identifier namespaces and
extend existing identity management practices. In section 4 we'll
consider, at a functional level, how Grouper may be made to articulate
with an existing infrastructure.
</p
<p>
In addition to this Implementation Guide, the Grouper 0.5.5 distribution
contains javadoc and other germinal guides for developers (i.e., good
intention outweighs substance at the moment). All of these are found in
the doc/ directory of the distribution, which also contains a file
called NEWS that lists features in 0.5.5, those that are slated for a
future release, and known problems with 0.5.5. If this document and the
NEWS file appear to be in conflict on any point, the NEWS file should
be considered authoritative.
</p>
<p>
Perhaps the best source of API usage guidelines for developers at the
moment is the set of contributed programs and the suite of test
programs included with the distribution. They exercise many functional
aspects of the API, and the latter serve as the benchmark by which to
assess that a Grouper installation is working properly.
</p>
<p>
"Grouper Phase 1 Specifications" contains an Entity Relationship
Diagram for an early form of the Groups Registry schema. An ERD of the
schema deployed in Grouper 0.5.5 can be found 
<a href="http://middleware.internet2.edu/dir/groups/docs/groupsRegERD4.4.gif">here</a>.
</p>
<p>
In the rest of this document <i>italics</i> are used when introducing or
defining terms and for file, method, class, and table names.
</p>
<div id="section">
<h3>2. Building Grouper 0.5.5</h3>
<p>
The top-level directory of the unpacked Grouper 0.5.5 distribution
contains the following directories and files:
</p>
<p>
<table id="table" align="center" border="0">
<tr>
  <td id="td"><i>conf/</i></td>
  <td id="td">&nbsp;</td>
  <td id="td">various configuration files for Grouper and 3rd party
    components</td>
</tr>
<tr>
  <td id="td"><i>contrib/</i></td>
  <td id="td">&nbsp;</td>
  <td id="td">contributed software</td>
</tr>
<tr>
  <td id="td"><i>doc/</i></td>
  <td id="td">&nbsp;</td>
  <td id="td">nascent document repository</td>
</tr>
<tr>
  <td id="td">&nbsp;</td>
  <td id="td"><i>javadoc/</i></td>
  <td id="td">javadoc for the Grouper 0.5.5 API</td>
</tr>
<tr>
  <td id="td"><i>java/</i></td>
  <td id="td">&nbsp;</td>
  <td id="td">&nbsp;</td>
</tr>
<tr>
  <td id="td">&nbsp;</td>
  <td id="td"><i>lib/</i></td>
  <td id="td">3rd party jar files that grouper depends on</td>
</tr>
<tr>
  <td id="td">&nbsp;</td>
  <td id="td"><i>src/</i></td>
  <td id="td">source for Grouper 0.5.5</td>
</tr>
<tr>
  <td id="td">&nbsp;</td>
  <td id="td"><i>tests/</i>
  <td id="td">test programs</td>
</tr>
<tr>
  <td id="td"><i>sql/</i></td>
  <td id="td">&nbsp;</td>
  <td id="td">sql scripts for creating, initializing, and testing the
    Groups Registry</td>
</tr>
<tr>
  <td id="td"><i>LICENSE</i></td>
  <td id="td">&nbsp;</td>
  <td id="td">license under which Grouper 0.5.5 may be used</td>
</tr>
<tr>
  <td id="td"><i>build.xml</i></td>
  <td id="td">&nbsp;</td>
  <td id="td">ant configuration file</td>
</tr>
</table>
</p>
<p>
The file <i>java/lib/README</i> lists the 3rd party software used by Grouper
0.5.5 and identifies the version, source, and license for each. README
files occur here and there - you should read them!
</p>
<p>
We'll use the symbol "<i>$GROUPER_BASE</i>" below to refer to the top
level directory of your Grouper distribution.
</p>
<div id="subsection">
<h4>2.1 Build Instructions</h4>
</div>
<ol>
  <li>Get the latest Java SDK (from 
    <a href="http://java.sun.com/j2se">&lt;http://java.sun.com/j2se&gt;</a>).
    The JRE alone is not sufficient.</li>
  <li><p>Get ant (from 
    <a href="http://ant.apache.org/">&lt;http://ant.apache.org&gt;</a>).</p>
    <p>Directions for installing ant are in the unpacked distribution
    at <i>docs/manual/install.html#installing</i>. You may need to
    copy <i>tools.jar</i> from <i>$JAVA_HOME/lib</i> to
    <i>$ANT_HOME/lib</i> to get ant working properly.</p></li>
  <li>Change directory to the root of the unpacked Grouper 0.5.5
    distribution.</li>
  <li><p>Do "ant build".</p>
    <p>This will compile grouper and place the class files under
    the <i>$GROUPER_BASE/build</i> directory.</p></li>
  <li>Do "ant db-init db-init-test" to create and test the Groups
    Registry in the HSQLDB database provided. The database is created
    in the <i>$GROUPER_BASE/dist/run/</i> directory.
  <ol>
    <li>A "HSQL Database Manager" window will pop up with some
      commands preloaded. Press "Execute", wait for the result, then
      exit the HSQL Database Manager.</li>
    <li>A second HSQL Database Manager window will pop up with some
      more commands preloaded, but this time you'll see a list of
      tables in the Grouper Registry in the left-hand pane of the
      window. Press "Execute". At this point the Groups Registry
      has been seeded with definitions of the "base" and "naming"
      group types (in the <i>grouper_type</i>, <i>grouper_type_def</i>,
      and <i>grouper_field</i> tables) and the "GrouperSystem"
      subject has been created in the grouper_subject table.  You
      can execute select statements to see these, just for fun.
      Exit the HSQL Database Manager when you're done.</li>
    <li>A third HSQL Database Manager window will pop up with yet more
      commands preloaded. These will test that the HSQLDB instance
      is in fact working by entering a few test values into the
      grouper_subject table.  Press the "Execute" button. Exit the
      HSQL Database Manager when you're done.</li>
  </ol>
  <li><p>Do "ant test". This compiles and runs a suite of test
    programs that exercise the API to ensure that all's well. The
    testing log is in the <i>$GROUPER_BASE/dist/run/</i>
    directory.</p>
    <p>At any point you can run "ant db" in the <i>$GROUPER_BASE</i> directory
    to fire up the HSQL Database Manager app to look at what's in
    the Groups Registry. You'll have full access to the database
    when you do.</p></li>
  <li>Do "ant dist" to create two jar files containing all of
    Grouper's components and the 3rd party libraries on which it
    depends, located in <i>$GROUPER_BASE/dist/lib</i>. This will
    ease classpath formation for running Grouper from locations
    outside of <i>$GROUPER_BASE</i>.</li>
</ol>
</p>
<div id="subsection">
<h4>2.2 Configuring Grouper</h4>
</div>
<p>
Grouper 0.5.5 has only a few configuration options. The configuration
files are in the <i>$GROUPER_BASE/conf</i> directory. That directory contains
five files, one that should not be modified, another that can be
modified only with care, and three that should be modified. Do not
modify <i>Grouper.hbm.xml</i>. With care, you can modify
<i>ehcache.xml</i> to tweak cache parameters but not to add or
remove caches. Do modify <i>Grouper.properties</i>,
<i>hibernate.properties</i>, and <i>log4j.properties</i> as follows.
</p>
<p>
The <i>Grouper.properties</i> file for version 0.5.5 contains just three
declarations. First is the <i>subjectID</i> for Grouper's superuser, by
default <i>GrouperSystem</i>. This subject has unlimited privilege within the
Grouper API. The other two declarations specify the classes
implementing Grouper's Access and Naming Privilege Interfaces.
These are defaulted to use Grouper's internal privilege
implementation.
</p>
<p>
The <i>hibernate.properties</i> and <i>log4j.properties</i> must be
changed to reflect the location of each Grouper installation. In
<i>conf/hibernate.properties</i>, change:
<pre>
  hibernate.connection.url = jdbc:hsqldb:/FULL/PATH/TO/dist/run/grouper
</pre>
And in <i>conf/log4j.properties</i>, change:
<pre>
  log4j.appender.rfile.File = /FULL/PATH/TO/dist/run/grouper.log
</pre>
</p>
<p>
Other declarations in those files may also be changed to reflect
desired logging characteristics or use of an alternate RDBMS.
</p>
<div id="subsection">
<h4>2.3 Running Grouper</h4>
</div>
<p>
To run a java program using the Grouper 0.5.5 API, the java environment
must have a classpath that includes:
<ul>
  <li>full pathname of the Grouper.jar file produced by "ant dist"</li>
  <li>full pathname of the Grouper-lib.jar file produced by "ant dist", and</li>
  <li>full pathname of the directory containing Grouper's configuration files.</li>
</ul>
</p>
<div id="subsection">
<h4>2.4 Building And Running Sample Applications</h4>
</div>
<p>
Grouper 0.5.5 includes four sample programs to aid in getting started
with a Grouper deployment.
</p>
<div id="subsection">
<h4>2.4.1 Sample Subject Loader - csv2subject</h4>
<div>
<p>
The out-of-the-box method for providing Grouper 0.5.5 with subjects,
i.e., identifiers for people or other objects that are potential group
members, is to load them in to the <i>grouper_subject</i> table. The subject
loader is a very simple program for so doing. It takes a comma
separated list of <i>subjectID</i>, <i>subjectTypeID</i> and loads them directly into
the table. Subjects and the preferred means of dealing with them are
discussed in sections 3.6 and 4.3 below.
</p>
<p>
The <i>$GROUPER_BASE/contrib/load/csv2subject</i> directory has a
simple subject loader and a sample csv file for loading subjects
into a test database. To use it,
<ol>
  <li>change to the <i>$GROUPER_BASE/contrib/load/csv2subject</i>
    directory</li>
  <li>read the README file and follow its instructions.</li>
</ol>
<i>csv2subject</i> uses JDBC to communicate directly with the database,
i.e.  it does not use the Grouper API. Its configuration file,
<i>csv2subject.properties</i>, will need to be modified to work with a
different database product (see section 4.1).
</p>
<div id="subsection">
<h4>2.4.2 Sample Group Loader - csv2group</h4>
</div>
<p>
The <i>csv2group</i> program is a very simple means to add namespaces,
groups, and members to the Groups Registry. However, it doesn't
delete groups or memberships - that is an exercise left to each
site's developers! To use it,
<ol>
  <li>change to the <i>$GROUPER_BASE/contrib/load/csv2group</i> directory</li>
  <li>read the README file and follow its instructions.</li>
</ol>
The <i>csv2group</i> program interacts with the Groups Registry as the
<i>GrouperSystem</i> subject. You'll want to add the subjects in the
<i>csv2subject/sample.csv</i> file before loading the sample groups in this
<i>sample.csv</i> - the members of the sample groups are taken from the
list of sample subjects.
</p>
<div id="subsection">
<h4>2.4.3 Sample Group Manager - groupmgr</h4>
</div>
<p>
The <i>groupmgr</i> program provides a command line interface to
add namespaces to the Groups Registry and to add and delete groups
and memberships. Unlike <i>csv2group</i>, you can specify which
subject <i>groupmgr</i> should act as. To use it,
<ol>
  <li>change to the <i>$GROUPER_BASE/contrib/load/groupmgr</i>
    directory</li>
  <li>read the README file and follow its instructions.</li>
</ol>
</p>
<div id="subsection">
<h4>2.4.4 Sample Query Tool - grouperq</h4>
</div>
<p>
The <i>grouperq</i> program provides a command line interface for
performing simple queries on the Groups Registry. It is also useful
for "running as" a given subject as a means of verifying the subject's
access privileges. To use it,
<ol>
  <li>change to the <i>$GROUPER_BASE/contrib/load/groupmgr</i>
    directory</li>
  <li>read the README file and follow its instructions.</li>
</ol>
</p>
</div>
<div id="section">
<h3>3 Using Grouper's Data And Privilege Models</he>
</div>
<p>
Grouper works by managing two principal types of objects: groups and
namespaces. A group is a list of members and other associated data that
can be referred to in several ways. A namespace is a context in which a
group is named. From the perspective of information management, a
Grouper deployment is defined by which people and applications have
what access to each namespace and group. In this section we present
Grouper's data and privilege models and discuss several aspects of
a Grouper deployment: naming, distributing management of groups, and
choice of identifiers for members.
</p>
<div id="subsection">
<h4>3.1 Grouper 0.5.5 Fields</h4>
<div>
<p>
In Grouper parlance, each group has a set of <i>fields</i>, and each field can
either be a list or an attribute. In Grouper 0.5.5, a <i>list</i> is a
multivalued set of subjects and an <i>attribute</i> is a single-valued string.
Each subject has a single <i>subjectType</i>, the full set of which is
determined by each implementation site. As shipped, Grouper 0.5.5 has
<i>subjectTypes</i> of <i>person</i> and <i>group</i> and its groups
have the following default set of list and attribute fields.
</p>
<p>
<table id="table" align="center" border="1">
<th>Field</th>
<th>List Or Attribute?</th>
<th>Public Or Private?</th>
<th>Semantics</th>
<tr>
  <td id="td">guid</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">system-assigned, read-only, globally unique identifier
    for the group that is never reassigned or revoked</td>
</tr>
<tr>
  <td id="td">stem</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">the namespace in which the group is named</td>
</tr>
<tr>
  <td id="td">extension</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">relative name of the group within its namespace</td>
</tr>
<tr>
  <td id="td">name</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">system-maintained, read-only string representation
    of the logical ordered pair of (stem, extension), used to facilitate
    searching for groups by name</td>
</tr>
<tr>
  <td id="td">displayExtension</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">alternative string for representing the extension
    attribute</td>
</tr>
<tr>
  <td id="td">displayName</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">system-maintained, read-only string representation
    of the logical ordered pair of (displayName of stem, displayExtension),
    used to facilitate searching for groups by displayed name</td>
</tr>
<tr>
  <td id="td">description</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">semantics defined by implementation site</td>
</tr>
<tr>
  <td id="td">members</td>
  <td id="td">list</td>
  <td id="td">public</td>
  <td id="td">subjects belonging to this group</td>
</tr>
<tr>
  <td id="td">viewers</td>
  <td id="td">list</td>
  <td id="td">private</td>
  <td id="td">subjects with VIEW privilege for this group</td>
</tr>
<tr>
  <td id="td">readers</td>
  <td id="td">list</td>
  <td id="td">private</td>
  <td id="td">subjects with READ privilege for this group</td>
</tr>
<tr>
  <td id="td">updaters</td>
  <td id="td">list</td>
  <td id="td">private</td>
  <td id="td">subjects with UPDATE privilege for this group</td>
</tr>
<tr>
  <td id="td">admins</td>
  <td id="td">list</td>
  <td id="td">private</td>
  <td id="td">subjects with ADMIN privilege for this group</td>
</tr>
<tr>
  <td id="td">optins</td>
  <td id="td">list</td>
  <td id="td">private</td>
  <td id="td">subjects with OPTIN privilege for this group</td>
</tr>
<tr>
  <td id="td">optouts</td>
  <td id="td">list</td>
  <td id="td">private</td>
  <td id="td">subjects with OPTOUT privilege for this group</td>
</tr>
</table>
<div align="center"><b>Table 1 - Fields of "base" type</b></div>
</p>
<p>
Fields listed as "private" in this table are maintained for use by the
API while "public" ones are maintained for use by calling programs, and
the <i>viewers</i> through <i>optouts</i> lists are used only if
Grouper's default privilege implementation is used (see section
3.4). So, a group is a list of members, a description, and a set
of naming elements, together with privileges that subjects have
over those things.
</p>
<p>
Grouper 0.5.5 namespaces have the following fields.
</p>
<p>
<table id="table" align="center" border="1">
<th>Field</th>
<th>List Or Attribute?</th>
<th>Public Or Private?</th>
<th>Semantics</th>
<tr>
  <td id="td">guid</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">system-assigned, read-only, globally unique identifier
    for the namespace that is never reassigned or revoked</td>
</tr>
<tr>
  <td id="td">stem</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">the namespace to which this one is subordinate</td>
</tr>
<tr>
  <td id="td">extension</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">relative name of the namespace within its parent namespace</td>
</tr>
<tr>
  <td id="td">name</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">system-maintained, read-only string representation
    of the logical ordered pair of (stem, extension), used to facilitate
    searching for namespaces by name</td>
</tr>
<tr>
  <td id="td">displayExtension</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">alternative string for representing the extension
    attribute</td>
</tr>
<tr>
  <td id="td">displayName</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">system-maintained, read-only string representation
    of the logical ordered pair of (displayName of stem, displayExtension),
    used to facilitate searching for namespaces by displayed name</td>
</tr>
<tr>
  <td id="td">description</td>
  <td id="td">attribute</td>
  <td id="td">public</td>
  <td id="td">semantics defined by implementation site</td>
</tr>
<tr>
  <td id="td">creators</td>
  <td id="td">list</td>
  <td id="td">private</td>
  <td id="td">subjects with CREATE privilege for this namespace</td>
</tr>
<tr>
  <td id="td">stemmers</td>
  <td id="td">list</td>
  <td id="td">private</td>
  <td id="td">subjects with STEM privilege for this namespace</td>
</tr>
</table>
<div align="center"><b>Table 2 - Fields of "naming" type</b></div>
</p>
<div id="subsection">
<h4>3.2 Extending Grouper's Fields</h4>
</div>
<p>
To support some of the 
<a href="http://middleware.internet2.edu/dir/docs/draft-internet2-mace-dir-sage-scenarios-00.html">use cases</a>
identified by MACE-Dir-Groups working group members, Grouper was
designed from the start to enable implementation sites to extend the
set of attributes and lists available to associate with some groups.
This was done by declaring attributes, lists, and their properties in
tables within the Groups Registry rather than having them represented
as static schematic elements of that database. Sets of attributes and
lists are packaged into group types, and, in a future release of
Grouper, each group can be assigned to any number of types. This is
similar to how schemas for LDAP directories are managed and extended:
LDAP attributes are packaged into objectclasses, and each LDAP entry
can have a set of objectclasses associated with it, allowing different
entries to serve different purposes. However, since in Grouper 0.5.5 a
group can have only a single type, each site using extended types will
need to ensure that each extended type includes all of the naming
related base fields, <i>members</i>, and all of the privilege lists unless the
site is using an access privilege interface implementation different
from Grouper's default.
</p>
<p>
Grouper 0.5.5 ships with two group types. All groups are of the
<i>base</i> type - its structure is given in Table 1. Namespaces are modeled
internally to Grouper as groups of <i>naming</i> type. Its structure is
given in Table 2.
</p>
<p>
Although the API provides no support for managing group types, a
site may alter or learn by example from the Groups Registry
initialization script <i>$GROUPER_BASE/sql/init.sql</i> to populate the
<i>grouper_type</i>, <i>grouper_typedef</i>, and <i>grouper_field</i>
tables to determine the set of attributes, lists, and group types
they want in their Grouper deployment.
</p>
<p>
Note: the <i>guid</i> attribute is an operational attribute. It is stored in
the database as the <i>grouper_group:groupID</i> column and exposed in the API
with the <i>Group.id()</i> method instead of with the
<i>Group.attribute()</i> method. In presentation and documentation
contexts we'll use the term <i>guid</i>.
</p>
<div id="subsection">
<h4>3.3 Naming Elements And Examples</h4>
</div>
<p>
Table 1 and Table 2 show that groups and namespaces have the same
naming attributes with the same semantics. Groups and namespaces are
created and named within namespaces, and namespaces can be arranged in
a flat or hierarchical style, as desired by each implementation site.
</p>
<p>
Since a group must be named within a namespace, it is necessary to
create a namespace before any groups can be created. In Grouper 0.5.5
namespaces are modeled as groups of naming type, so namespaces and
groups are created in a similar manner, using the
<i>GrouperGroup.create()</i> method. Groups are created using a
form of the create method that defaults to creating groups of the
default, base, type. Namespaces are created using a form of the
create method in which a non-default type is explicitly declared.
For example, the following code fragment creates a top-level namespace
named "uofc" and then creates a group named "exec_council" within
the "uofc" namespace.
<pre>
  String stem = Grouper.NS_ROOT;
  String extn = "uofc";
  GrouperGroup ns = GrouperGroup.create(s, stem, extn, Grouper.NS_TYPE);

  String stem = "uofc";
  String extn = "exec_council";
  GrouperGroup g = GrouperGroup.create(s, stem, extn);
</pre>
</p>
<p>
A <i>hierarchy delimiter</i> is used in string representations of the names of
groups and namespaces. The delimiter is a ":" character in Grouper
0.5.5, but in the next release it will be a configurable choice
within a constrained set of characters. Continuing the example
above, the <i>name</i> of the "exec_council" group within the "uofc"
namespace is "uofc:exec_council".
</p>
<p>
Each newly created group or namespace contributes just one new element,
the <i>extension</i>, to its accumulative name.  <i>displayName</i>s groups and
namespaces are likewise accumulative - that's why the <i>name</i> and
<i>displayName</i> attributes are system maintained and read-only. Here are
some further examples illustrating all of the naming attributes of
several namespaces and groups.
</p>
<p>
<table id="table" align="center" border="1">
<th span="2">namespace uofc</th>
<tr>
  <td id="td"><i>stem</i></td>
  <td id="td">&nbsp;</td>
</tr>
<tr>
  <td id="td"><i>extension</i></td>
  <td id="td">uofc</td>
</tr>
<tr>
  <td id="td"><i>displayExtension</i></td>
  <td id="td">University Of Chicago</td>
</tr>
<tr>
  <td id="td"><i>name</i></td>
  <td id="td">uofc</td>
</tr>
<tr>
  <td id="td"><i>displayName</i></td>
  <td id="td">University Of Chicago</td>
</tr>
</table>
</p>
<p>
<table id="table" align="center" border="1">
<th span="2">group uofc:exec_council</th>
<tr>
  <td id="td"><i>guid</i></td>
  <td id="td">258a158b-3f40-43d4-a4b2-c97398c6ad19</td>
</tr>
<tr>
  <td id="td"><i>stem</i></td>
  <td id="td">uofc</td>
</tr>
<tr>
  <td id="td"><i>extension</i></td>
  <td id="td">exec_councel</td>
</tr>
<tr>
  <td id="td"><i>displayExtension</i></td>
  <td id="td">Executive Council</td>
</tr>
<tr>
  <td id="td"><i>name</i></td>
  <td id="td">uofc:exec_council</td>
</tr>
<tr>
  <td id="td"><i>displayName</i></td>
  <td id="td">University Of Chicago:Executive Council</td>
</tr>
</table>
</p>
<p>
<table id="table" align="center" border="1">
<th span="2">namespace uofc:bsd</th>
<tr>
  <td id="td"><i>stem</i></td>
  <td id="td">uofc</td>
</tr>
<tr>
  <td id="td"><i>extension</i></td>
  <td id="td">bsd</td>
</tr>
<tr>
  <td id="td"><i>displayExtension</i></td>
  <td id="td">Biological Sciences Division</td>
</tr>
<tr>
  <td id="td"><i>name</i></td>
  <td id="td">uofc:bsd</td>
</tr>
<tr>
  <td id="td"><i>displayName</i></td>
  <td id="td">University Of Chicago:Biological Sciences Division</td>
</tr>
</table>
</p>
<p>
<table id="table" align="center" border="1">
<th span="2">group uofc:bsd:eis_staff</th>
<tr>
  <td id="td"><i>guid</i></td>
  <td id="td">82a303fa-cb6b-4330-b085-46a1974b0a79</td>
</tr>
<tr>
  <td id="td"><i>stem</i></td>
  <td id="td">uofc:bsd</td>
</tr>
<tr>
  <td id="td"><i>extension</i></td>
  <td id="td">eis_staff</td>
</tr>
<tr>
  <td id="td"><i>displayExtension</i></td>
  <td id="td">Enterprise Information Systems staff</td>
</tr>
<tr>
  <td id="td"><i>name</i></td>
  <td id="td">uofc:bsd:eis_staff</td>
</tr>
<tr>
  <td id="td"><i>displayName</i></td>
  <td id="td">University Of Chicago:Biological Sciences Division:Enterprise
    Information Systems staff</td>
</tr>
</table>
</p>
<p>
<div align="center"><b>Figure 1 - Naming Examples</b></div>
</p>
This set of examples illuminates at least two things. First, that it
would be a good idea for implementation sites to establish conventions
for the assignment of naming attributes. An example of such is 
<a href="http://techag.uchicago.edu/idm-wg/attrValueBNF.txt">here</a>
(note that it was created before Grouper's design encompassed
<i>displayName</i>s, and at that time the term <i>descriptor</i>
was used where we now say <i>extension</i>).
</p>
<p>
Second, that the names of groups, as with the titles of many types of
things, influence people's initial expectations of the meaning of
those groups. Seeing "Enterprise Information Systems staff" by itself
gives a different impression than seeing it in the context of
"Biological Sciences Division". That, in part, motivates the care taken
in the design of Grouper's privilege model, introduced next.
</p>
<p>
Note that <i>displayExtension</i> and <i>displayName</i>, although declared in
Grouper 0.5.5's <i>base</i> type, are not exposed in the API. That
will come with the 0.5.5 maintenance release.
</p>
<div id="subsection">
<h4>3.4 Grouper 0.5.5 Privileges</h4>
</div>
<p>
There are two categories of privileges in Grouper. Access privileges
determine what a subject can do to a group. Naming privileges determine
what a subject can do to a namespace. These are listed in the following
table.
</p>
<p>
<table id="table" align="center" border="1">
<th>Privilege</th>
<th>Interface</th>
<th>Description</th>
<tr>
  <td id="td"><i>VIEW</i></td>
  <td id="td">access</td>
  <td id="td">Can see the group and can refer to it, e.g., to make
    it a subgroup of another group.</td>
</tr>
<tr>
  <td id="td"><i>READ</i></td>
  <td id="td">access</td>
  <td id="td">Can read all "public" fields of the group. Implies
    <i>VIEW</i>.</td>
</tr>
<tr>
  <td id="td"><i>UPDATE</i></td>
  <td id="td">access</td>
  <td id="td">Can update the group's members list and can grant and
    revoke <i>OPTIN</i> and <i>OPTOUT</i> privilege for this group.
    Implies <i>READ</i>.</td>
</tr>
<tr>
  <td id="td"><i>ADMIN</i></td>
  <td id="td">access</td>
  <td id="td">Can modify all group fields, can grant and revoke all
    access privileges, can rename the group, and can delete the
    group.</td>
</tr>
<tr>
  <td id="td"><i>OPTIN</i></td>
  <td id="td"><i>access</i></td>
  <td id="td">Can add oneself to the members list of the group. Implies
    <i>VIEW</i>.</td>
</tr>
<tr>
  <td id="td"><i>OPTOUT</i></td>
  <td id="td">access</td>
  <td id="td">Can remove oneself from the members list of the group.
    Implies <i>VIEW</i>.</td>
</tr>
<tr>
  <td id="td"><i>CREATE</i></td>
  <td id="td">naming</td>
  <td id="td">Can create a group in the namespace.</td>
</tr>
<tr>
  <td id="td"><i>STEM</i></td>
  <td id="td">naming</td>
  <td id="td">Can grant and revoke <i>CREATE</i> and <i>STEM</i>
    privilege for the namespace and can create a subordinate
    namespace.</td>
</tr>
</table>
<div align="center"><b>Table 3 - Privileges</b></div>
</p>
<p>
Grouper filters group loads and search hits based on a subject's
<i>VIEW</i> and <i>READ</i> privileges for each matched group. Subjects
lacking <i>VIEW</i> privilege to a group will not have that group's
existence revealed to them by the Grouper API. Subjects with
<i>VIEW</i> but lacking <i>READ</i> can read the group's naming
attributes and no others. <i>OPTOUT</i> privilege to a group does not
enable the subject to remove themselves from effective membership in
the group, only immediate membership. The creator of a group is
automatically granted <i>ADMIN</i> privilege to the group. The creator
of a namespace is automatically granted <i>STEM</i> privilege to the
namespace. Although <i>STEM</i> privilege does not imply <i>CREATE</i>
privilege, a subject with <i>STEM</i> privilege can assign themselves
<i>CREATE</i> privilege.
</p>
<p>
<b>Caveat: Some of the above privilege characteristics will be fully
implemented only in the next release, a maintenance release to be
called Grouper 0.5.5.</b>
</p>
<p>
Top-level namespaces, i.e., those for which the stem attribute is the
constant <i>Grouper.NS_ROOT</i>, can only be created by the
<i>GrouperSystem</i> distinguished subject in Grouper 0.5.5.
</p>
<p>
The Grouper API presents and itself uses abstracted interfaces,
<i>GrouperAccess</i> and <i>GrouperNaming</i>, to manage access and
naming privileges. This design permits implementation sites to replace
Grouper's default implementation of either or both of these
interfaces with ones of their own devise, in case the site has or will
have privilege management capabilities with which they wish to
integrate management of Grouper privileges (see section 4.5).
</p>
<p>
The privilege interfaces permit privileges to be assigned to subjects
of any type, including groups. An implementation of the privilege
interfaces that relies on Grouper to resolve subjects that are groups
can take advantage of Grouper's subgroup, compound group, and aging
capabilities to enrich privilege management. In particular,
Grouper's default privilege implementation uses group management to
support inheritance and aging of privileges.
</p>
<p>
Although it is not possible to extend Grouper's privilege model,
sites that extend the set of attributes and lists in their deployment
can declare which privileges are needed to read and to write each
attribute and list. These declarations are in the <i>grouper_field</i>
table.  Although the API provides no support for managing extended
fields or their security, sites may alter or learn by example from the
Groups Registry initialization script <i>$GROUPER_BASE/sql/init.sql</i>
to do so.
</p>
<div id="subsection">
<h4>3.5 Using Privileges To Distribute Group Management
Capabilities</h4>
</div>
<p>
One of the leading reasons why there is interest in Grouper is that
many sites recognize a need to involve many sources of authority in
managing resource access, distribution lists, and application
customization - the types of needs which groups help to satisfy.
Grouper's privilege model supports five ways to distribute
management of groups.
<ol>
  <li>Create a group and assign someone <i>UPDATE</i> privilege to
    it.  This delegates the ability to maintain the group's
    membership.</li>
  <li>Create a group and assign someone <i>ADMIN</i> privilege to it.
    This delegates the ability to manage who can maintain the group's
    membership as well as manage all access to the group.</li>
  <li>Create a namespace and assign someone <i>CREATE</i> privilege
    to it. This delegates the ability to preside over the collection
    of all groups they create in that namespace.</li>
  <li>Create a namespace and assign someone <i>STEM</i> privilege
    to it.  They can rule over an entire hierarchy of namespaces and
    groups, all sharing a common root namespace.</li>
  <li>Create a group and assign <i>OPTIN</i> and/or <i>OPTOUT</i>
    privilege to other groups. Subjects belonging to those other
    groups are entitled to manage their own membership in the
    group.</li>
</ol>
</p>
<p>
An example of an actual scenario for delegation of group management to
solve an access control problem can be found in
<a href="http://home.uchicago.edu/~tbarton/camp-200411/20041117-authz.ppt">&lt;http://home.uchicago.edu/~tbarton/camp-200411/20041117-authz.ppt&gt;</a>.
</p>
<div id="subsection">
<h4>3.6 Subject Identifiers</h4>
</div>
<p>
Most often the members of your groups will be people and other groups.
But they might also be of any other type (applications or computers,
for example) for which you now or eventually will manage identities.
Grouper 0.5.5 supports a site-defined set of <i>subjectTypes</i> (see section
4.3 below).
</p>
<p>
Identifiers and their management can get complicated. They can be
revoked or not, re-assigned or not, lucent or opaque, etc. Depending on
such characteristics, a given identifier might be a good or bad choice
to use in the context of managing the identified subject's group
memberships.
</p>
<p>
For example, a username is often lucent - easily remembered by the
person to whom it is associated. But it may also be revokable, meaning
that it no longer refers to that person (perhaps they have a new one),
or even re-assignable, meaning that it might refer to some other person
at a later time. If a username is used to record membership, username
changes must trigger corresponding membership changes. A username is
better suited to authentication than it is to indicating membership.
</p>
<p>
On the other hand, an opaque registryID (machine, not human, readable)
that never changes is great for membership, but lousy for
authentication - it might not even be known by the person to whom
it is associated. How would I identify myself to Grouper if I wished to
opt-in to a list or manage a group?
</p>
<p>
Grouper accommodates subject identifier issues in two ways. First, it
maintains guids for every subject and group in the deployment. These
are never exposed by the API, but are associated with externally
supplied subject identifiers in the <i>grouper_member</i> table.
This approach allows the identifier associated with a given subject
to be changed without any need to change actual memberships (although
the supporting GrouperMember method is only slated for inclusion
in the 0.5.5 release).
</p>
<p>
Second, by release 0.6, the Grouper API will incorporate an identifier
lookup and translation service called the Subject Interface being
co-developed by the Grouper and Signet projects. The Subject Interface
is used to lookup subjects that are presented with an identifier in one
namespace and obtain identifiers in other namespaces for that subject.
That means that it can translate a username into a registryID and
vice-versa, for example. So, when a user authenticates to an
application using the Grouper API, that application can use the Subject
Interface to fetch an identifier for that person chosen by the site for
use in memberships. Similarly, when a membership in the Groups Registry
is to be expressed elsewhere, the identifier used for group members can
be translated by a provisioning connector by use of the Subject
Interface into one that is suitable in the provisioned context.
</p>
<div id="section">
<h3>Integration Tasks</h3>
</div>
<p>
Things you'll need to do to integrate grouper with your infrastructure
and practices.
</p>
<div id="subsection">
<h4>4.1 Using Your Own RDBMS</h4>
</div>
<p>
Grouper 0.5.5 ships with the HSQLDB relational database and Hibernate
(<a href="http://www.hibernate.org/">&lt;http://www.hibernate.org/&gt;</a>) 
for object persistence. Hibernate uses JDBC to coonnect to an RDBMS,
so it should not be difficult to make Grouper use any of a variety
of common RDBMS systems.
</p>
<p>
To use an alternate database you'll need to
<ol>
  <li>amend Grouper's Hibernate configuration file to connect to
    your RDBMS, and</li>
  <li>arrange an alternative database initialization process.</li>
</ol>
</p>
<p>
The Hibernate configuration is in
<i>$GROUPER_BASE/conf/hibernate.properties</i>. Several of its
declarations will need to be modified. We intend to add subsections
at this point in the Implementation Guide detailing how various
databases have been connected with Grouper based on the experiences
of early adopters.
</p>
<p>
The "db-init" ant target in <i>$GROUPER_BASE/build.xml</i> creates and
initializes the database relying on SQL scripts located in the
<i>$GROUPER_BASE/sql/</i> directory. Although these are believed and intended
to be vanilla SQL92 and if so ought to work for other relational
databases, this has not been verified as yet. Some modification may be
required. And the "db-init" ant target itself is specific to HSQLDB.
You will need to use an alternative method to initialize a different
RDBMS.
</p>
<p>
To verify that your database is functioning correctly with Grouper,
change directory to <i>$GROUPER_BASE</i> and run "ant test".
</p>
<div id="subsection">
<h4>4.1 SQL Tuning</h4>
</div>
<p>
To Be Done based on experiences of early adopters.
</p>
<div id="subsection">
<h4>4.2 Getting Subjects Into Grouper</h4>
</div>
<p>
Section 3.6 broached issues surrounding the choice of subject
identifiers for use with Grouper. Having made a choice, this section
tells you how to get those identifiers integrated with Grouper. You
may want to stare at the 
<a href="http://middleware.internet2.edu/dir/groups/docs/groupsRegERD4.4.gif">Groups Registry ERD</a> 
while reading this section.
</p>
<p>
The <i>grouper_subjectType</i> table is used to declare what
<i>subjectTypes</i> are in a Grouper deployment, and, for each type,
the name of the adapterClass that will be called to lookup and load
objects of each type. Grouper 0.5.5 installs with this table defaulted
to support two subject types: <i>person</i> and <i>group</i>. The
default <i>person</i> adapter class, called
<i>SubjectTypeAdapterPersonImpl</i>, provides sites with a bootstrap to
getting subjects into Grouper 0.5.5. It just looks in the
<i>grouper_subject</i> table to qualify that the <i>subjectID</i>
supplied to the Grouper API is valid. So all you've got to do initially
is populate the <i>grouper_subject</i> table with all of the
<i>subjectIDs</i> encompassed by your Grouper deployment, which is what
the <i>csv2subject</i> contributed program does (see section 2.4.1).
</p>
<p>
A better means of integrating your person type <i>subjectIDs</i> with Grouper
0.5.5 is to supply your own adapter class for the <i>person
subjectType</i>. This class will need to validate and create subject objects given a
<i>subjectID</i>. So, for example, it might hit your LDAP directory or your
Person Registry directly to validate that a <i>subjectID</i> is in fact one
that is valid for a group management operation. This would remove the
need to maintain the <i>grouper_subject</i> table - its sole purpose in
the Groups Registry is to bootstrap subjects into Grouper.
</p>
<p>
With implementation of the Subject Interface, anticipated for Grouper
0.6, a richer set of subject data obtained from your identity
management operation is made available to implement identifier
translation capabilities as described in section 3.6 and subject search
capabilities in support of the Grouper UI. The default adapter class for
the <i>person subjectType</i> in Grouper 0.6 will support these identifier
search and translation capabilities by reliance on the
<i>grouper_subjectAttribute</i> table. That will allow you to bootstrap your
Grouper deployment by maintaining this table until such time as you can
supply your own <i>person subjectType</i> adapter class with the requisite
functionality.
</p>
<p>
NOTE: The adapter class for the <i>group subjectType</i> should not
be changed!  Else why are you bothering with Grouper?
</p>
<div id="subsection">
<h4>4.3 Loaders And Provisioning Connectors</h4>
<div>
<p>
Loaders and provisioning connectors are defined in the 
<a href="http://middleware.internet2.edu/dir/groups/docs/draft-internet2-mace-dir-grouper-phase1-specs-04.html#heading_2_Comp">components & architecture section</a>
in <a href="http://middleware.internet2.edu/dir/groups/docs/draft-internet2-mace-dir-grouper-phase1-specs-04.html">Grouper Phase 1 Specifications</a>. 
Loaders are automation process that use the Grouper API to load and
maintain the Groups Registry from other sources, and provisioning
connectors are automation processes that use the Grouper API to
extract information from the Groups Registry and represent it in
other databases, directories, etc.
</p>
<p>
As this is the initial release, there is as yet no contributed code
that has been used to get real data into or out of Grouper, although
the contributed applications discussed in section 2.4 above could be
used as a starting point for developing them. So this section will
merely identify some of Grouper's capabilities relative to loaders
and provisioning connectors.
</p>
<p>
All interactions with the Grouper API are conducted within a session
that is constrained by the privileges of the session's <i>subjectID</i>,
so each loader and provisioning connector will need to be assigned one.
The default <i>GrouperSystem</i> subject can be used, or others may be
assigned as necessary to meet site-specific security requirements.
</p>
<p>
The Grouper API does not authenticate the <i>subjectID</i> asserted by an API
client. It is assumed that sites will secure access to the Grouper API
as they do other infrastructure services, with a combination of host
and application platform security measures.
</p>
<p>
Loaders and provisioning connectors may use the Subject Interface,
after its incorporation into Grouper in release 0.6, to lookup and
translate external identifiers for subjects into those selected for use
as Grouper <i>subjectIDs</i>.
</p>
<p>
The <i>GrouperQuery</i> class encapsulates the search filters implemented in
Grouper 0.5.5 for selecting groups. These include
<ul>
  <li>specifying a time before which the group was modified</li>
  <li>specifying a time after which the group was modified</li>
  <li>specifying a time before which the group was created</li>
  <li>specifying a time after which the group was created</li>
  <li>specifying a group <i>type</i></li>
  <li>specifying whether the group has immediate or effective
    memberships, or both.</li>
</ul>
</p>
<p>
These filters can be combined to constrain a single search. A search is
executed using the selected filters by the <i>GrouperQuery.query()</i> method.
Further search capabilities are slated for later releases of Grouper.
See <a href="http://middleware.internet2.edu/dir/groups/docs/draft-internet2-mace-dir-grouper-search-00.html">Grouper API Search & Browse Capabilities</a>
for details.
</p>
<p>
Grouper 0.5.5 has no way to limit the number of objects returned by a
search. That too is planned for a subsequent release.
</p>
<p>
<i>GrouperQuery.query()</i> and the <i>GrouperGroup</i> and
<i>GrouperMember</i> <i>list*</i> methods for listing immediate and effective memberships return lists of
<i>GrouperList</i> objects. The <i>GrouperList.group()</i> and
<i>GrouperList.member()</i> methods convert <i>GrouperList</i> objects
into <i>GrouperGroup</i> or <i>GrouperMember</i> objects, respectively.
</p>
<p>
In the case of a list value that is a <i>GrouperMember</i> object representing
an effective membership, the <i>via</i> group for that membership is returned
by the <i>GrouperList.via()</i> method. A <i>via group</i> is a
group in which a member has an immediate membership that qualifies
it for effective membership by virtue of a subgroup or compound
group relationship between the via group and the group in which the
member has effective membership (the via group concept is discussed
in more detail in 
<a href="http://middleware.internet2.edu/dir/groups/docs/draft-internet2-mace-dir-grouper-phase1-specs-04.html">Grouper Phase 1 Specifications</a>). 
If there's more than one via group qualifying a given member's
effective membership in some group, then the list of <i>GrouperList</i>
objects returned by <i>GrouperGroup.listEffVals()</i> or
<i>GrouperMember.listEffVals()</i> contains a <i>GrouperMember</i>
object for each via group. This allows API clients like loaders and
provisioning connectors to determine which immediate memberships
must be removed in order to make a given effective membership go
away.
</p>
<p>
Each group in the Groups Registry has several <i>operational
attributes</i> associated with it. In Grouper 0.5.5 these include:
</p>
<p>
<table id="table" align="center" border="1">
<th>Operational Attribute</th>
<th>Description</th>
<tr>
  <td id="td"><i>createTime</i></td>
  <td id="td">time at which the group was created</td>
</tr>
<tr>
  <td id="td"><i>createSubject</i></td>
  <td id="td">the <i>memberKey</i> of the subject that created the
    group</td>
</tr>
<tr>
  <td id="td"><i>createSource</i></td>
  <td id="td">undefined in Grouper 0.5.5</td>
</tr>
<tr>
  <td id="td"><i>modifyTime</i></td>
  <td id="td">time at which the group was last modified</td>
</tr>
<tr>
  <td id="td"><i>modifySubject</i></td>
  <td id="td">the <i>memberKey</i> of the subject that last modifed the
    group</td>
</tr>
<tr>
  <td id="td"><i>modifySource</i></td>
  <td id="td">undefined in Grouper 0.5.5</td>
</tr>
</table>
<div align="center"><b>Table 4 - Operational Attributes For
Groups</b></div>
</p>
<p>
The <i>modifyTime</i> and <i>modifySubject</i> are updated with
each change to any of the group's fields. A change in effective
membership or effective privilege is not reflected in the values
of these operational attributes. Such a capability has been requested
for a future version of Grouper.
</p>
<p>
The <i>memberKey</i> referred to in this table is an internal globally unique
identifier that Grouper assigns to each subject it comes into contact
with. The <i>GrouperGroup.createSubject()</i> and
<i>GrouperGroup.modifySubject()</i> methods return
<i>Subject</i> objects corresponding to this <i>memberKey</i>.
</p>
<div id="subsection">
<h4>4.4 Integrating Grouper With An External Privilege Management
System</h4>
</div>
<p>
To be addressed with Grouper 0.6.
</p>
</body>
</html>
