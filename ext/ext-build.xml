<!-- $Id: ext-build.xml,v 1.2 2007-05-14 16:12:56 blair Exp $ -->

<project name="Grouper Extensions" default="ext.compile" basedir=".">

  <!-- MACROS -->

  <!-- macro: iterate -->
  <macrodef name="iterate">
    <attribute  name="target"/>
    <element    name="extensions" optional="yes"/>
    <sequential>
      <subant target="@{target}">
        <property name="GROUPER_CLASSPATH"  refid="project.classpath"/>
        <property name="GROUPER_CONF"       location="${conf.dir}"/>
        <property name="GROUPER_DOC_CSS"    location="${javadoc.css}"/>
        <property name="GROUPER_EXT_BIN"    location="${ext.dir.bin}"/>
        <property name="GROUPER_EXT_DOC"    location="${ext.dir.doc}"/>
        <property name="GROUPER_EXT_LIB"    location="${ext.dir.lib}"/>
        <property name="GROUPER_HOME"       location="${basedir}"/>
        <fileset dir="${ext.dir}" includes="*/build.xml"/>
      </subant>
    </sequential>
  </macrodef>
  <!-- macro: iterate -->


  <!-- TARGETS -->

  <!-- target: ext.clean -->
  <target name="ext.clean">
    <delete dir="${ext.dir.bin}"/>
    <delete dir="${ext.dir.doc}"/>
    <delete>
      <fileset dir="${ext.dir.lib}"/>
    </delete>
    <iterate target="ext.clean"/>
  </target>
  <!-- target: ext.clean -->

  <!-- target: ext.compile -->
  <target name="ext.compile" 
          depends="ext.init"
  >
    <iterate target="ext.compile"/>
  </target>
  <!-- target: ext.compile -->

  <!-- target: ext.doc -->
  <target name="ext.doc" 
          depends="ext.init"
  >
    <iterate target="ext.doc"/>
  </target>
  <!-- target: ext.doc -->

  <!-- target: ext.init -->
  <target name="ext.init">
    <mkdir dir="${ext.dir.bin}"/>
    <mkdir dir="${ext.dir.doc}"/>
    <mkdir dir="${ext.dir.lib}"/>
  </target>
  <!-- target: ext.init -->

  <!-- target: ext.install -->
  <!-- installs extension and supporting files in 'standard' locations -->
  <target name="ext.install" 
          depends="ext.init"
  >
    <iterate target="ext.install"/>
  </target>
  <!-- target: ext.install -->

  <!-- target: ext.test -->
  <target name="ext.test" 
          depends="ext.init">
    <iterate target="ext.test"/>
  </target>
  <!-- target: ext.install -->

</project>

