<?xml version="1.0"?>
<!DOCTYPE database SYSTEM "http://db.apache.org/torque/dtd/database.dtd">
<database name="model">

  <table name="grouper_attributes">
    <column name="id"/> 
    <column name="group_id"/> 
    <column name="field_name"/> 
    <column name="value"/> 

    <foreign-key name="fk_attributes_group_id" foreignTable="grouper_groups">
      <reference local="group_id" foreign="uuid"/>
    </foreign-key>

    <foreign-key name="fk_attributes_field_name" foreignTable="grouper_fields">
      <reference local="field_name" foreign="name"/>
    </foreign-key>
  </table>

  <table name="grouper_composites">
    <column name="id"/> 
    <column name="uuid"/> 
    <column name="owner"/> 
    <column name="left_factor"/> 
    <column name="right_factor"/> 
    <column name="type"/> 
    <column name="creator_id"/> 
    <column name="create_time"/> 

    <foreign-key name="fk_composites_owner" foreignTable="grouper_groups">
      <reference local="owner" foreign="uuid"/>
    </foreign-key>

    <foreign-key name="fk_composites_left_factor" foreignTable="grouper_groups">
      <reference local="left_factor" foreign="uuid"/>
    </foreign-key>

    <foreign-key name="fk_composites_right_factor" foreignTable="grouper_groups">
      <reference local="right_factor" foreign="uuid"/>
    </foreign-key>

    <foreign-key name="fk_composites_creator_id" foreignTable="grouper_members">
      <reference local="creator_id" foreign="member_uuid"/>
    </foreign-key>
  </table>

  <table name="grouper_fields">
    <column name="id"/> 
    <column name="field_uuid"/> 
    <column name="grouptype_uuid"/> 
    <column name="is_nullable"/> 
    <column name="name"/> 
    <column name="read_privilege"/> 
    <column name="type"/> 
    <column name="write_privilege"/> 

    <foreign-key name="fk_fields_grouptype_uuid" foreignTable="grouper_types">
      <reference local="grouptype_uuid" foreign="type_uuid"/>
    </foreign-key>
  </table>

  <table name="grouper_groups">
    <column name="id"/> 
    <column name="uuid"/> 
    <column name="parent_stem"/> 
    <column name="creator_id"/> 
    <column name="create_time"/> 
    <column name="modifier_id"/> 
    <column name="modify_time"/> 
    <column name="create_source"/> 
    <column name="modify_source"/> 

    <foreign-key name="fk_groups_parent_stem" foreignTable="grouper_stems">
      <reference local="parent_stem" foreign="uuid"/>
    </foreign-key>

    <foreign-key name="fk_groups_creator_id" foreignTable="grouper_members">
      <reference local="creator_id" foreign="member_uuid"/>
    </foreign-key>

    <foreign-key name="fk_groups_modifier_id" foreignTable="grouper_members">
      <reference local="modifier_id" foreign="member_uuid"/>
    </foreign-key>
  </table>

  <table name="grouper_groups_types">
    <column name="id"/> 
    <column name="group_uuid"/> 
    <column name="type_uuid"/> 

    <foreign-key name="fk_groups_types_group_uuid" foreignTable="grouper_groups">
      <reference local="group_uuid" foreign="uuid"/>
    </foreign-key>

    <foreign-key name="fk_groups_types_type_uuid" foreignTable="grouper_types">
      <reference local="type_uuid" foreign="type_uuid"/>
    </foreign-key>
  </table>

  <table name="grouper_members">
    <column name="id"/>
    <column name="member_uuid"/>
    <column name="subject_id"/>
    <column name="subject_source"/>
    <column name="subject_type"/>
  </table>

  <table name="grouper_memberships">
    <column name="id"/> 
    <column name="owner_id"/> 
    <column name="member_id"/> 
    <column name="list_name"/> 
    <column name="list_type"/> 
    <column name="mship_type"/> 
    <column name="via_id"/> 
    <column name="depth"/> 
    <column name="parent_membership"/> 
    <column name="membership_uuid"/> 
    <column name="creator_id"/> 
    <column name="create_time"/> 

    <foreign-key name="fk_memberships_member_id" foreignTable="grouper_members">
      <reference local="member_id" foreign="member_uuid"/>
    </foreign-key>

    <foreign-key name="fk_memberships_list_name_type" foreignTable="grouper_fields">
      <reference local="list_name" foreign="name"/>
      <reference local="list_type" foreign="type"/>
    </foreign-key>

    <foreign-key name="fk_memberships_parent" foreignTable="grouper_memberships">
      <reference local="parent_membership" foreign="membership_uuid"/>
    </foreign-key>

    <foreign-key name="fk_memberships_creator_id" foreignTable="grouper_members">
      <reference local="creator_id" foreign="member_uuid"/>
    </foreign-key>
  </table>

  <table name="grouper_sessions">
    <column name="id"/> 
    <column name="member_id"/> 
    <column name="starttime"/> 
    <column name="session_uuid"/> 

    <foreign-key name="fk_sessions_member_id" foreignTable="grouper_members">
      <reference local="member_id" foreign="member_uuid"/>
    </foreign-key>
  </table>

  <table name="grouper_stems">
    <column name="id"/> 
    <column name="uuid"/> 
    <column name="parent_stem"/> 
    <column name="name"/> 
    <column name="display_name"/> 
    <column name="creator_id"/> 
    <column name="create_time"/> 
    <column name="modifier_id"/> 
    <column name="modify_time"/> 
    <column name="display_extension"/> 
    <column name="extension"/> 
    <column name="description"/> 
    <column name="create_source"/> 
    <column name="modify_source"/> 

    <foreign-key name="fk_stems_parent_stem" foreignTable="grouper_stems">
      <reference local="parent_stem" foreign="uuid"/>
    </foreign-key>

    <foreign-key name="fk_stems_creator_id" foreignTable="grouper_members">
      <reference local="creator_id" foreign="member_uuid"/>
    </foreign-key>

    <foreign-key name="fk_stems_modifier_id" foreignTable="grouper_members">
      <reference local="modifier_id" foreign="member_uuid"/>
    </foreign-key>
  </table>

  <table name="grouper_types">
    <column name="id"/> 
    <column name="type_uuid"/> 
    <column name="name"/> 
    <column name="creator_uuid"/> 
    <column name="create_time"/> 
    <column name="is_assignable"/> 
    <column name="is_internal"/> 

    <foreign-key name="fk_types_creator_uuid" foreignTable="grouper_members">
      <reference local="creator_uuid" foreign="member_uuid"/>
    </foreign-key>
  </table>

  <table name="Subject">
    <column name="subjectId"/>
    <column name="subjectTypeId"/>
    <column name="name"/>
  </table>

  <table name="SubjectAttribute">
    <column name="subjectId"/>
    <column name="name"/>
    <column name="value"/>
    <column name="searchValue"/>
    
    <foreign-key name="fk_subjectattr_subjectid" foreignTable="Subject">
      <reference local="subjectId" foreign="subjectId"/>
    </foreign-key>
  </table>

</database>
